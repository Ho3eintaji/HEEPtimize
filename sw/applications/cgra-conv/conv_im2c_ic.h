#ifndef _CONV_CGRA_IM2C_IC_H_
#define _CONV_CGRA_IM2C_IC_H_

#include <stdint.h>
#include <stdint.h>
#include "kernels_common/kernels_common.h"
#include "data.h"


#define IN_VAR_DEPTH_IM2C_IC    8
#define OUT_VAR_DEPTH_IM2C_IC   1

// static void         config( int32_t *in );
static void    config_im2c_ic();
const uint32_t cgra_imem_conv_im2c_ic[CGRA_IMEM_SIZE] = {0xa90000, 0xad0000, 0xa080009, 0x1ac00004, 0x6bb0000, 0x8b80000, 0x17180000, 0x190f0000, 0x6a090040, 0x8a0d0040, 0xab80004, 0x1a100001, 0x10880004, 0x90080000, 0x15080000, 0x0, 0x0, 0x0, 0x0, 0xc80000, 0xc80000, 0xa90000, 0xad0000, 0x0, 0x0, 0x6bb0000, 0x8b80000, 0x17180000, 0x190f0000, 0x6a090040, 0x8a0d0040, 0x0, 0x0, 0x0, 0x90080000, 0x15080000, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa90000, 0xad0000, 0x0, 0x0, 0x6bb0000, 0x8b80000, 0x17180000, 0x190f0000, 0x6a090040, 0x8a0d0040, 0x0, 0x0, 0x0, 0x90080000, 0x15080000, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa90000, 0xad0000, 0x0, 0x0, 0x6bb0000, 0x8b80000, 0x17180000, 0x190f0000, 0x6a090040, 0x8a0d0040, 0x0, 0x0, 0x0, 0x90080000, 0x15080000, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa90000, 0xad0000, 0x0, 0x0, 0x6bb0000, 0x8b80000, 0x17180000, 0x190f0000, 0x6a090040, 0x8a0d0040, 0x0, 0x0, 0x4ac00004, 0x90080000, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa90000, 0xad0000, 0x0, 0x0, 0x6bb0000, 0x8b80000, 0x17180000, 0x190f0000, 0x6a090040, 0x8a0d0040, 0x0, 0x0, 0x0, 0x90080000, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa90000, 0xad0000, 0x0, 0x0, 0x6bb0000, 0x8b80000, 0x17180000, 0x190f0000, 0x6a090040, 0x8a0d0040, 0x0, 0x0, 0x0, 0x90080000, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa90000, 0xad0000, 0x0, 0x0, 0x6bb0000, 0x8b80000, 0x17180000, 0x190f0000, 0x6a090040, 0x8a0d0040, 0x0, 0x0, 0x0, 0x90080000, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa90000, 0xad0000, 0x0, 0x0, 0x6bb0000, 0x8b80000, 0x17180000, 0x190f0000, 0x6a090040, 0x8a0d0040, 0x0, 0x0, 0x0, 0x90080000, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa90000, 0xad0000, 0x0, 0x0, 0x6bb0000, 0x8b80000, 0x17180000, 0x190f0000, 0x6a090040, 0x8a0d0040, 0x0, 0x0, 0x0, 0x90080000, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa90000, 0xad0000, 0x0, 0x0, 0x6bb0000, 0x8b80000, 0x17180000, 0x190f0000, 0x6a090040, 0x8a0d0040, 0x0, 0x0, 0x0, 0x90080000, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa90000, 0xad0000, 0x0, 0x0, 0x6bb0000, 0x8b80000, 0x17180000, 0x190f0000, 0x6a090040, 0x8a0d0040, 0x0, 0x0, 0x0, 0x90080000, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa90000, 0xad0000, 0x0, 0x0, 0x6bb0000, 0x8b80000, 0x17180000, 0x190f0000, 0x6a090040, 0x8a0d0040, 0x0, 0x0, 0x0, 0x90080000, 0x14080000, 0x15080000, 0x13080000, 0x0, 0x0, 0x0, 0x0, 0xa90000, 0xad0000, 0x0, 0x0, 0x6bb0000, 0x8b80000, 0x17180000, 0x190f0000, 0x6a090040, 0x8a0d0040, 0x0, 0x0, 0x0, 0x90080000, 0x14080000, 0x15080000, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa90000, 0xad0000, 0x0, 0x0, 0x6bb0000, 0x8b80000, 0x17180000, 0x190f0000, 0x6a090040, 0x8a0d0040, 0x0, 0x0, 0x0, 0x90080000, 0x14080000, 0x15080000, 0x0, 0x0, 0x0, 0x0, 0x0, 0xa90000, 0xad0000, 0x0, 0x0, 0x6bb0000, 0x8b80000, 0x17180000, 0x190f0000, 0x6a090040, 0x8a0d0040, 0x0, 0x0, 0x0, 0x90080000, 0x14080000, 0x15080000, 0x12080000, 0x13080000, 0x10b00000, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0};
const uint32_t cgra_kmem_conv_im2c_ic[CGRA_KMEM_SIZE] = {0x0, 0xf014, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0};

static int32_t cgra_input_im2c_ic[CGRA_N_COLS][IN_VAR_DEPTH_IM2C_IC]     __attribute__ ((aligned (4)));
static int32_t cgra_output_im2c_ic[CGRA_N_COLS][OUT_VAR_DEPTH_IM2C_IC]   __attribute__ ((aligned (4)));


kcom_kernel_t conv_im2c_ic_kernel = {
    .kmem   = cgra_kmem_conv_im2c_ic,
    .imem   = cgra_imem_conv_im2c_ic,
    .col_n  = CGRA_N_COLS,
    .in_n   = IN_VAR_DEPTH_IM2C_IC,
    .out_n  = OUT_VAR_DEPTH_IM2C_IC,
    .input  = cgra_input_im2c_ic,
    .output = cgra_output_im2c_ic,
    .config = config_im2c_ic,
    .name   = "conv_im2c_ic",
};

void config_im2c_ic()
{
    int output_channel;

    for(int i = 0; i < 4; i++){
        cgra_input_im2c_ic[0][i] = &(input[4*i]  );
        cgra_input_im2c_ic[1][i] = &(input[4*i+1] );
        cgra_input_im2c_ic[2][i] = &(input[4*i+2]);
        cgra_input_im2c_ic[3][i] = &(input[4*i+3]);
    }

    for(int i = 4; i < 8; i++){
        cgra_input_im2c_ic[0][i]=&(filter[output_channel][0][0][(i%4)*4]);
        cgra_input_im2c_ic[1][i]=&(filter[output_channel][0][0][1+(i%4)*4]);
        cgra_input_im2c_ic[2][i]=&(filter[output_channel][0][0][2+(i%4)*4]);
        cgra_input_im2c_ic[3][i]=&(filter[output_channel][0][0][3+(i%4)*4]);
    }
}

#endif /* _CONV_CGRA_IM2C_IC_H_ */